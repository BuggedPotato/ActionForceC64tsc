/*! For license information please see main.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,i,e,s,n,o,r={843:(t,i,e)=>{e.d(i,{DX:()=>_,G5:()=>g,KN:()=>l,X4:()=>o,X_:()=>c,Xl:()=>d,Zf:()=>p,d0:()=>r,qd:()=>h,s_:()=>a,yH:()=>n});var s=e(286);const n={chopper:{idleLsrc:"./src/gfx/sprites/chopper/idle_left_spritesheet.bmp",idleRsrc:"./src/gfx/sprites/chopper/idle_right_spritesheet.bmp",turnSrc:"./src/gfx/sprites/chopper/turning_spritesheet.bmp",destroyedSrc:"./src/gfx/sprites/chopper/destroyed_spritesheet.bmp"},car:{idleRsrc:"./src/gfx/sprites/car/car_spritesheet.bmp",destroyedSrc:"./src/gfx/sprites/chopper/destroyed_spritesheet.bmp"},jet:{idleRsrc:"./src/gfx/sprites/jet/jet_r_spritesheet.bmp",idleLsrc:"./src/gfx/sprites/jet/jet_l_spritesheet.bmp",destroyedSrc:"./src/gfx/sprites/jet/jet_destroyed_spritesheet.bmp"},jetProjectiles:{idleRsrc:"./src/gfx/sprites/projectiles/jet_projectile.bmp",destroyedSrc:"./src/gfx/sprites/chopper/destroyed_spritesheet.bmp"},helikopter:{idleLsrc:"./src/gfx/sprites/helikopter/helikopter_l_spritesheet.bmp",idleRsrc:"./src/gfx/sprites/helikopter/helikopter_r_spritesheet.bmp",turnSrc:"./src/gfx/sprites/helikopter/helikopter_turn_spritesheet.bmp",destroyedSrc:"./src/gfx/sprites/chopper/destroyed_spritesheet.bmp"},rocket:{idleRsrc:"./src/gfx/sprites/projectiles/chopper_rocket_right.bmp",idleLsrc:"./src/gfx/sprites/projectiles/chopper_rocket_left.bmp",destroyedSrc:"./src/gfx/sprites/chopper/destroyed_spritesheet.bmp"},bomb:{idleRsrc:"./src/gfx/sprites/projectiles/bomb.bmp"},bridge:{idleRsrc:"./src/gfx/sprites/buildings/bridge.bmp"},ammoSign:{idleRsrc:"./src/gfx/sprites/buildings/ammo_sign_0.bmp"},fuelSign:{idleRsrc:"./src/gfx/sprites/buildings/fuel_sign_0.bmp"},spike:{idleRsrc:"./src/gfx/sprites/buildings/spike.bmp"},wall:{idleRsrc:"./src/gfx/sprites/buildings/wall.bmp"}},o={rocket:28,bomb:20,car:2,jet:18,jetProjectile:18},r={soundtrack:"./src/sound/action_force_ost.mp3",shot:"./src/sound/shot.mp3",engineering:"./src/sound/bridge_interaction.mp3",death:"./src/sound/death.mp3"},h={backgroundSrc:"./src/gfx/gui/player_gui_bg.bmp",overlaySrc:"./src/gfx/gui/charset/charset.bmp",fuelLowImgSrc:"./src/gfx/gui/fuel_low.bmp"},a={fps:50,frameInterval:20,maxEnemies:4},l={fuelTickDuration:7,fuelPerRefuelSecond:4,ammoPerResupplySecond:16,animationInterval:2*a.frameInterval,deathAnimationInterval:7*a.frameInterval,maxFuel:25,maxAmmo:200,maxBombs:100,minVelocityFactor:.16,criticalVelocityFactor:4,acceleration:2.5,guiBgCanvasId:"player-gui-bg",guiCanvasId:"player-gui"},_={hitpoints:100,animationInterval:4*a.frameInterval,deathAnimationInterval:8*a.frameInterval},c={jet:{deathAnimationInterval:7*a.frameInterval,projectiles:{deathAnimationInterval:2*a.frameInterval},shootingInterval:700},helikopter:{acceleration:2.5,animationInterval:4*a.frameInterval,deathAnimationInterval:7*a.frameInterval}},d={crtOn:"checkbox-crt",gameCanvasId:"game",backgroundCanvasId:"background",overlayCanvasId:"overlay",crtCanvasId:"crt"},p=[...Object.values(s.s)];var g={crt:!1}},448:(t,i,e)=>{e.d(i,{L:()=>s});const s={sounds:{},init:t=>{s.sounds={};for(const i in t)s.sounds[i]=new Audio(t[i])},play:t=>{s.sounds[t].currentTime>0&&(s.sounds[t].pause(),s.sounds[t].currentTime=0),s.sounds[t].play()}}},382:(t,i,e)=>{e.d(i,{l:()=>c});var s=e(843),n=e(286),o=e(909),r=e(27),h=e(448),a=e(158),l=e(823),_=e(89);class c extends a.J{constructor(t,i,e,n,o,r,h){super({x:t,y:i},e,o,r,h),this._velocity=n,this._iAmAlive=!0,this._isFalling=!1,this._lastAnimationTick=window.performance.now(),this.hp=s.DX.hitpoints}frame(){this._iAmAlive&&(this.checkZones(),this.updatePosition(),this.updateCollisionBox())}draw(){if(!this._iAmAlive)return void this.wereDoneFor();const t=this._canvas.getContext("2d"),i=this.getDrawingPos();this._SPRITES?(window.performance.now()-this._lastAnimationTick>s.DX.animationInterval&&(this._spritesheetPosition.x+=48,this._spritesheetPosition.x>=this._SPRITES.idleR.naturalWidth&&(this._spritesheetPosition.x=0),this._lastAnimationTick=window.performance.now()),t.drawImage(this._SPRITES.idleR,this._spritesheetPosition.x,this._spritesheetPosition.y,48,40,i,this._position.y,this._size.x,this._size.y)):(t.fillStyle="gold",t.fillRect(i,this._position.y,this._size.x,this._size.y))}wereDoneFor(){const t=this.getDrawingPos();if(this._spritesheetPosition.x>=this._SPRITES.destroyed.naturalWidth)return void this._engine.delete(o.p.Car);const i=this._canvas.getContext("2d");i.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y,48,42,t,this._position.y,this._size.x,this._size.y),i.filter=l.Z.randomColourFilter(),i.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y+42,48,42,t,this._position.y,this._size.x,this._size.y),i.filter=n.s.Black,window.performance.now()-this._lastAnimationTick>=s.DX.deathAnimationInterval&&(this._spritesheetPosition.x+=48,this._lastAnimationTick=window.performance.now())}updatePosition(){const t=this.collided();if(l.Z.isCollision(t))return void this.die();const i={x:this._engine.player.position.x+this._engine.player.size.x/2,y:this._engine.player.position.y+this._engine.player.size.y/3*2};this.isInside(i)&&Date.now()%40<10&&this.mayday(),this._position.addVector(this._velocity),this._isFalling&&this._position.addVector(new _.F(0,8))}checkZones(){const t={x:this._collisionBox.bl.x,y:this._collisionBox.bl.y-1};this._engine.level.bridges.map(((i,e)=>{!i.built&&i.zone.isInside(t)&&(this._isFalling=!0)}));let i=this._engine.level.zones.find((t=>t.type===r.E.Exit));void 0!==i&&i.isInside(t)&&alert("========= END ========")}mayday(t=1){this.hp-=t,this.hp<=0&&(this._iAmAlive=!1)}die(){this._iAmAlive=!1,this._lastAnimationTick=window.performance.now(),this._engine.fpsStuff.frameCount=0,h.L.play("death")}getDrawingPos(){return this._position.x-5*this._engine.backgroundOffset}get alive(){return this._iAmAlive}}},158:(t,i,e)=>{e.d(i,{J:()=>n});var s=e(89);class n{constructor(t,i,e,s,n,o){this._spritesheetPosition={y:0,x:0},this._size=t,this._position=i,this._engine=e,this._canvas=document.getElementById(s),n&&this.setSprites(n,"idleLsrc"in n,"turnSrc"in n,"destroyedSrc"in n),"boolean"==typeof o&&(this._isDestructible=o,!1===o&&(this.destroy=void 0)),this.updateCollisionBox()}updateCollisionBox(){this._collisionBox={tr:{x:this._position.x+this._size.x,y:this._position.y},br:{x:this._position.x+this._size.x,y:this._position.y+this._size.y},tl:{x:this._position.x,y:this._position.y},bl:{x:this._position.x,y:this._position.y+this._size.y}}}draw(){const t=this._canvas.getContext("2d");let i=this._position.x-5*this._engine.backgroundOffset;this._SPRITES?t.drawImage(this._SPRITES.idleR,0,0,this._size.x,this._size.y,i,this._position.y,5*this._size.x,5*this._size.y):(t.fillStyle="red",t.fillRect(i,this._position.y,this._size.x,this._size.y))}destroy(){this._engine.deleteObstacle(this)}isInside(t){return t.x>this._collisionBox.tl.x&&t.x<this._collisionBox.tr.x&&t.y>this._collisionBox.tr.y&&t.y<this._collisionBox.br.y}collided(){const t=Object.values(this._collisionBox),i=Object.keys(this._collisionBox),e=this._engine.level.obstacles,n=new s.F(0,1);let o;o=this._engine.player?Math.acos((this._engine.player.velocity.x*n.x+this._engine.player.velocity.y*n.y)/(this._engine.player.velocity.magnitude*n.magnitude))/Math.PI*180:0;for(let t=0;t<e.length;t++){const s=Object.values(e[t].collisionBox);for(let n=0;n<s.length;n++)if(this.isInside(s[n]))return{point:i[n],pointPos:s[n],angle:o,parent:e[t],target:this}}for(let s=0;s<e.length;s++)for(let n=0;n<t.length;n++)if(e[s].isInside(t[n]))return{point:i[n],pointPos:t[n],angle:o,parent:this,target:e[s]};return null}async setSprites(t,i,e,s){let n=new Image;if(n.src=t.idleRsrc,await n.decode(),this._SPRITES={idleR:n},i){let i=new Image(100,100);i.src=t.idleLsrc,await i.decode(),this._SPRITES.idleL=i}if(e){let i=new Image(100,100);i.src=t.turnSrc,await i.decode(),this._SPRITES.turn=i}if(s){let i=new Image(100,100);i.src=t.destroyedSrc,await i.decode(),this._SPRITES.destroyed=i}}set engine(t){this._engine=t}get collisionBox(){return this._collisionBox}get position(){return this._position}get size(){return this._size}get isDestructible(){return this._isDestructible}}},875:(t,i,e)=>{e.d(i,{h:()=>d});var s=e(843),n=e(286),o=e(2),r=e(909),h=e(448),a=e(158),l=e(823),_=e(720),c=e(89);class d extends a.J{constructor(t,i,e,n,r,h,a){super({x:t,y:i},e,n,r,h),this._ACCELERATION=s.X_.helikopter.acceleration,this._SPRITES=a,this._lastAnimationTick=window.performance.now(),this.setRocketSprites(),this._lastAnimationTick=window.performance.now(),this.velocityFactor=0,this._velocity=new c.F(0,0),this._direction=o.N.East,this._isTurning=!1,this._iAmAlive=!0,this._moveBusy=!1,this._lastShootingTick=window.performance.now()}async frame(){this._iAmAlive&&(await this.updateVelocity(),this.updatePosition(),this.updateCollisionBox(),this.updateDirection(),this.tryShoot())}draw(){if(!this._iAmAlive)return void this.wereDoneFor();let t=this.getDrawingPos();const i=this._canvas.getContext("2d");if(this._SPRITES){let e,n=1;const r={x:48,y:42};this._isTurning?(e=this._SPRITES.turn,n=this._direction==o.N.East?-1:1):e=this._direction==o.N.East?this._SPRITES.idleR:this._SPRITES.idleL,window.performance.now()-this._lastAnimationTick>=s.X_.helikopter.animationInterval&&(this._spritesheetPosition.x+=r.x*n,(this._spritesheetPosition.x>=e.naturalWidth||this._spritesheetPosition.x<0)&&(this._spritesheetPosition.x=0,e=this._direction==o.N.East?this._SPRITES.idleR:this._SPRITES.idleL,this._isTurning=!1),this._lastAnimationTick=window.performance.now()),i.drawImage(e,this._spritesheetPosition.x,this._spritesheetPosition.y,r.x,r.y,t,this._position.y,this._size.x,this._size.y)}else i.fillStyle="gold",i.fillRect(t,this._position.y,this._size.x,this._size.y)}async updateVelocity(){if(!this._engine.player)return;0==this.velocityFactor&&(this.velocityFactor=this._position.x-this._engine.player.position.x>=0?-1:1);const t=this._position.x-this._engine.player.position.x>0&&this.velocityFactor>0,i=this._position.x-this._engine.player.position.x<0&&this.velocityFactor<0,e=t||i,s=this._engine.player.position.y-this._position.y;if(!this._moveBusy){let t;e&&(t=5e3*Math.random()+100,this._moveBusy=!0,await l.Z.sleepyTime(t),await this.turnAround(),this._moveBusy=!1)}this._velocity=new c.F(this._ACCELERATION*this.velocityFactor,s/100),this._velocity.addVector(new c.F(0,this._ACCELERATION/4))}async turnAround(){const t=this.velocityFactor<=0?1:-1;do{this.velocityFactor+=t,await l.Z.sleepyTime(110)}while(Math.abs(this.velocityFactor)<4);return new Promise((t=>setTimeout((()=>t(!0)),800)))}updateDirection(){this._velocity.x>0&&this._direction==o.N.West?(this._isTurning=!0,this._direction=o.N.East,this._spritesheetPosition.x=192):this._velocity.x<0&&this._direction==o.N.East&&(this._isTurning=!0,this._direction=o.N.West,this._spritesheetPosition.x=0)}updatePosition(){let t=new a.J(this._size,this._position,this._engine,this._canvas.id);t.position.addVector(this._velocity),t.updateCollisionBox();const i=t.collided();let e=this._velocity.normalized();if(e.multiply(-.1),l.Z.isCollision(i)){for(this.velocityFactor=0;null!=t.collided();)t.position.addVector(e),t.updateCollisionBox();this._position=t.position}else this._position.addVector(this._velocity),this._position.x+this._size.x>this._engine.level.bounds.tr.x?(this._position.x=this._engine.level.bounds.tr.x-this._size.x,this._velocity.x=0):this._position.x<this._engine.level.bounds.tl.x&&(this._position.x=this._engine.level.bounds.tl.x,this._velocity.x=0),this._position.y+this._size.y>this._engine.level.bounds.bl.y?this._position.y=this._engine.level.bounds.bl.y-this._size.y:this._position.y<this._engine.level.bounds.tl.y&&(this._position.y=this._engine.level.bounds.tl.y)}tryShoot(){if(!this._engine.player)return;const t=Math.abs(this._position.x-this._engine.player.position.x),i=Math.abs(this._position.y-this._engine.player.position.y),e=t<this._engine.level.SCREEN_WIDTH&&i<60;let s,n,o=!1;this._engine.car&&(s=Math.abs(this._position.x-this._engine.car.position.x),n=Math.abs(this._position.y-this._engine.car.position.y),o=s<this._engine.level.SCREEN_WIDTH&&n<60),window.performance.now()-this._lastShootingTick>800&&(o||e)&&(this.shoot(),this._lastShootingTick=window.performance.now())}shoot(){const t=this._position.copy();t.addXY({x:this._direction==o.N.East?this.size.x:0,y:this.size.y/3*2});const i=new c.F(this._direction==o.N.East?s.X4.rocket:-s.X4.rocket,0),e=new _.W(r.p.Enemy,{x:40,y:20},i,t,this._engine,this._canvas.id,this._ROCKET_SPRITE);this._engine.projectiles.push(e),h.L.play("shot")}mayday(){this._iAmAlive&&this.die()}wereDoneFor(){const t=this.getDrawingPos();if(this._spritesheetPosition.x>=this._SPRITES.destroyed.naturalWidth)return void this._engine.deleteEnemy(this);const i=this._engine.level.OL_CANVAS.getContext("2d");i.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y,48,42,t,this._position.y,this._size.x,this._size.y),i.filter=l.Z.randomColourFilter(),i.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y+42,48,42,t,this._position.y,this._size.x,this._size.y),i.filter=n.s.Black,window.performance.now()-this._lastAnimationTick>=s.X_.helikopter.deathAnimationInterval&&(this._spritesheetPosition.x+=48,this._lastAnimationTick=window.performance.now())}die(){this._spritesheetPosition.x=0,this._lastAnimationTick=window.performance.now(),this._iAmAlive=!1,this._engine.fpsStuff.frameCount=0,h.L.play("death"),this._engine.player.score+=150}async setSprites(){console.log(":))))))))))))))))")}async setRocketSprites(){let t=s.yH.rocket,i=new Image(100,100);i.src=t.idleRsrc,await i.decode();let e=new Image(100,100);e.src=t.idleLsrc,await e.decode(),this._ROCKET_SPRITE={idleR:i,idleL:e}}getDrawingPos(){return this._position.x-5*this._engine.backgroundOffset}}},823:(t,i,e)=>{e.d(i,{Z:()=>n});var s=e(843);const n={isCollision:t=>null!=t&&void 0!==t.angle,isPlayer:t=>null!=t&&void 0!==t.velocity,isJet:t=>null!=t&&void 0!==t.ceiling,randomColourFilter:()=>s.Zf[Math.round(Math.random()*s.Zf.length)],distance:(t,i)=>Math.sqrt((t.x-i.x)**2+(t.y-i.y)**2),sleepyTime:async t=>new Promise((i=>setTimeout((()=>i(!0)),t)))}},455:(t,i,e)=>{e.d(i,{I:()=>n});var s=e(89);class n{constructor(){this.up=!1,this.down=!1,this.left=!1,this.right=!1,this.shoot=!1}start(t){this._accelerationTick=0,document.body.addEventListener("keydown",(i=>{switch(i.key){case"ArrowUp":this.up=!0;break;case"ArrowDown":this.down=!0;break;case"ArrowLeft":this.left=!0;break;case"ArrowRight":this.right=!0;break;case"Insert":case"z":t&&!this.shoot&&(this.down?t.dropBomb():t.shoot(),this.shoot=!0)}})),document.body.addEventListener("keyup",(i=>{switch(i.key){case"ArrowUp":t.velocity.scalarProduct(new s.F(1,0)),this.up=!1;break;case"ArrowDown":this.down=!1;break;case"ArrowLeft":this.left=!1;break;case"ArrowRight":this.right=!1;break;case"Insert":case"z":this.shoot=!1}}))}}},456:(t,i,e)=>{e.d(i,{z:()=>_});var s=e(843),n=e(909),o=e(448),r=e(158),h=e(823),a=e(720),l=e(89);class _ extends r.J{constructor(t,i,e,s,n,o,r,h){super(t,i,o,r,h),this._velocity=e,this._velocity.addVector(new l.F(0,2.5)),this._iAmAlive=!0,this._ceiling=s,this._exit=n,this._falling=!1,this._canShoot=!0,this.setProjectileSprites()}frame(){this.updatePosition(),this.updateCollisionBox(),this.tryShoot()}draw(){if(!this._iAmAlive)return void this.wereDoneFor();const t=this._canvas.getContext("2d"),i=this.getDrawingPos();if(this._SPRITES)try{t.drawImage(this._velocity.x>0?this._SPRITES.idleR:this._SPRITES.idleL,this._spritesheetPosition.x,this._spritesheetPosition.y,96,40,i,this._position.y,this._size.x,this._size.y)}catch(t){console.warn("Image not loaded?")}else t.fillStyle="blue",t.fillRect(i,this._position.y,this._size.x,this._size.y)}updatePosition(){this._iAmAlive&&(!this._falling&&this._position.y>=this._ceiling&&(this._velocity.y=0),0==this._velocity.y&&this._exit.isInside(this._collisionBox.tr)&&this._velocity.addVector(new l.F(0,-2.5)),this._position.addVector(this._velocity),this._position.y+this._size.y<0&&this.suicide(),this._falling&&(h.Z.isCollision(this.collided())||this._position.y+this._size.y>=this._engine.level.bounds.bl.y)&&this.die())}tryShoot(){if(!this._canShoot||this._falling||!this._engine.player||!this._engine.car)return;const t=Math.abs(this._position.x-this._engine.player.position.x),i=Math.abs(this._position.x-this._engine.car.position.x),e=this._engine.level.SCREEN_WIDTH/3;if(t<e||i<e){const t=300*Math.random();this._canShoot=!1,setTimeout((()=>{this.shoot(),setTimeout((()=>{this._canShoot=!0}),s.X_.jet.shootingInterval)}),t)}}shoot(){const t=new l.F(this._velocity.x<0?-s.X4.jetProjectile:s.X4.jetProjectile,s.X4.jetProjectile/2),i=new l.F(this._position.x+this._size.x/2,this._position.y+this._size.y);let e=new a.W(n.p.Jet,{x:136,y:118},t,i,this._engine,this._canvas.id,this._PROJECTILE_SPRITE,!0);this._engine.projectiles.push(e)}mayday(){this._falling=!0,this._velocity.addVector(new l.F(0,4)),this._engine.player.score+=300}wereDoneFor(){const t=this.getDrawingPos();this._spritesheetPosition.x>=this._SPRITES.destroyed.naturalWidth?this.suicide():(this._canvas.getContext("2d").drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y,96,42,t,this._position.y,this._size.x,this._size.y),window.performance.now()-this._lastAnimationTick>=s.X_.jet.deathAnimationInterval&&(this._spritesheetPosition.x+=96,this._lastAnimationTick=window.performance.now()))}die(){this._iAmAlive=!1,this._lastAnimationTick=window.performance.now(),this._engine.fpsStuff.frameCount=0,o.L.play("death")}suicide(){this._engine.delete(n.p.Jet)}async setProjectileSprites(){let t=s.yH.jetProjectiles,i=new Image(100,100);i.src=t.idleRsrc;let e=new Image(100,100);e.src=t.destroyedSrc,this._PROJECTILE_SPRITE={idleR:i,destroyed:e}}getDrawingPos(){return this._position.x-5*this._engine.backgroundOffset}get alive(){return this._iAmAlive}get ceiling(){return this._ceiling}}},937:(t,i,e)=>{e.d(i,{a:()=>l});var s=e(843),n=e(158),o=e(27),r=e(89),h=e(286),a=e(457);class l{constructor(t,i,e,h,a,l,_){this._BACKGROUND=new Image,this._OVERLAY=new Image,this._BRIDGE=new Image,this._REFUEL=new Image,this._RESUPPLY=new Image,this._bridges=[],this.setSprites(t,i),this._BOUNDS=e,this._obstacles=a,this._zones=l,this._zones.sort(((t,i)=>t.position.x-i.position.x)),this._zones.map((t=>{t.type==o.E.Bridge&&(this._bridges.push({position:{x:t.position.x,y:t.position.y+t.size.y},size:{x:120,y:85},built:_.includes(this._bridges.length),zone:t}),this._obstacles.push(new n.J(t.size,new r.F(t.position.x,t.position.y+85),null,s.Xl.gameCanvasId)))})),this._BG_CANVAS=document.getElementById(s.Xl.backgroundCanvasId),this._OL_CANVAS=document.getElementById(s.Xl.overlayCanvasId),this._CRT_CANVAS=document.getElementById(s.Xl.crtCanvasId);const c=document.getElementById(s.Xl.gameCanvasId);this._BG_CANVAS.getContext("2d").imageSmoothingEnabled=!1,this._OL_CANVAS.getContext("2d").imageSmoothingEnabled=!1,this._CRT_CANVAS.getContext("2d").imageSmoothingEnabled=!1,c.getContext("2d").imageSmoothingEnabled=!1,this.SCREEN_WIDTH=window.outerWidth/1.6,this._BG_CANVAS.width=this.SCREEN_WIDTH,this._OL_CANVAS.width=this.SCREEN_WIDTH,c.width=this.SCREEN_WIDTH,this._CRT_CANVAS.width=this.SCREEN_WIDTH,this._CRT_CANVAS.height=window.innerHeight,s.G5.crt&&this.drawCRT()}draw(t,i){const e=this._BG_CANVAS.getContext("2d");e.imageSmoothingEnabled=!1;const s=this._OL_CANVAS.getContext("2d");s.imageSmoothingEnabled=!1,e.clearRect(0,0,this._BG_CANVAS.width,this._BG_CANVAS.height),e.filter=h.s.Black,e.fillStyle=a.g.LightBlue,e.fillRect(0,0,this._BG_CANVAS.width,this._BG_CANVAS.height),i&&(e.filter=h.s.ForceBlack,s.filter=h.s.ForceBlack),e.drawImage(this._BACKGROUND,t,0,this.SCREEN_WIDTH/5,this._BG_CANVAS.height/5,0,0,this._BG_CANVAS.width,this._BG_CANVAS.height),s.clearRect(0,0,this._OL_CANVAS.width,this._OL_CANVAS.height),s.drawImage(this._OVERLAY,t,0,this.SCREEN_WIDTH/5,this._OL_CANVAS.height/5,0,0,this._OL_CANVAS.width,this._OL_CANVAS.height),this._bridges.map((i=>{let s=i.position.x-5*t;i.built&&s>=0-i.size.x&&s<this._BG_CANVAS.width&&e.drawImage(this._BRIDGE,0,0,24,17,s,i.position.y,120,85)})),this._obstacles.map((t=>{t.isDestructible&&t.draw()}));const n=this._zones.find((t=>t.type===o.E.Refuel));let r=n.position.x-5*t;r>0-n.size.x&&r<this._BG_CANVAS.width&&s.drawImage(this._REFUEL,0,0,this._REFUEL.naturalWidth,this._REFUEL.naturalHeight,r,n.position.y,5*this._REFUEL.naturalWidth,5*this._REFUEL.naturalHeight);const l=this._zones.find((t=>t.type===o.E.Resupply));r=l.position.x-5*t,r>0-l.size.x&&r<this._BG_CANVAS.width&&s.drawImage(this._RESUPPLY,0,0,this._RESUPPLY.naturalWidth,this._RESUPPLY.naturalHeight,r,l.position.y,5*this._RESUPPLY.naturalWidth,5*this._RESUPPLY.naturalHeight)}clearCRT(){this._CRT_CANVAS.getContext("2d").clearRect(0,0,this._CRT_CANVAS.width,this._CRT_CANVAS.height)}drawCRT(){let t=document.createElement("canvas");t.width=this._CRT_CANVAS.width,t.height=6;let i=t.getContext("2d");i.fillStyle="rgba(192, 153, 255, 0.18)",i.fillRect(0,0,t.width,t.height/2.3);const e=this._CRT_CANVAS.getContext("2d");e.fillStyle="rgba(192, 153, 255, 0.1)",e.fillRect(0,0,this._CRT_CANVAS.width,this._CRT_CANVAS.height),this.clearCRT(),e.fillStyle=e.createPattern(t,"repeat"),e.fillRect(0,0,this._CRT_CANVAS.width,this._CRT_CANVAS.height)}async setSprites(t,i){this._BACKGROUND.src=t,this._OVERLAY.src=i,this._BRIDGE.src=s.yH.bridge.idleRsrc,this._REFUEL.src=s.yH.fuelSign.idleRsrc,this._RESUPPLY.src=s.yH.ammoSign.idleRsrc,await this._BACKGROUND.decode(),await this._OVERLAY.decode(),await this._BRIDGE.decode(),await this._REFUEL.decode()}isInBounds(t){return t.position.x>this._BOUNDS.tl.x&&t.position.y+t.size.y<=this._BOUNDS.bl.y&&t.position.x+t.size.x<this._BOUNDS.tr.x&&t.position.y>0}get background(){return this._BACKGROUND}get overlay(){return this._OVERLAY}get bounds(){return this._BOUNDS}get obstacles(){return this._obstacles}get zones(){return this._zones}get bridges(){return this._bridges}get BG_CANVAS(){return this._BG_CANVAS}get OL_CANVAS(){return this._OL_CANVAS}set engine(t){this._engine=t,this._obstacles.map((t=>{t.isDestructible&&(t.engine=this._engine)}))}}},332:(t,i,e)=>{e.d(i,{J:()=>p});var s=e(823),n=e(158),o=e(89),r=e(720),h=e(2),a=e(843),l=e(27),_=e(286),c=e(448),d=e(909);class p extends n.J{constructor(t,i,e,s,n,r){super({x:t,y:i},e,s,n,r),this._MAX_AMMO=a.KN.maxAmmo,this._MAX_BOMBS=a.KN.maxBombs,this.MAX_FUEL=a.KN.maxFuel,this._ACCELERATION=a.KN.acceleration,this._ammo=100,this._bombs=50,this._fuel=0,this._bridges=0,this.score=0,this._velocity=new o.F(0,0),this.velocityFactor=0,this._direction=h.N.East,this._isTurning=!1,this._iAmAlive=!0,this._lastFuelTick=window.performance.now(),this._lastResupplyTick=window.performance.now(),this._lastRefuelTick=window.performance.now(),this._lastAnimationTick=window.performance.now(),this._accelerationTick=0,this.hp=5,this.setRocketSprites(),this.setBombSprites();let l=()=>{this._fuel++,this._fuel<this.MAX_FUEL&&setTimeout(l,160/a.KN.fuelPerRefuelSecond)};setTimeout(l,a.KN.fuelPerRefuelSecond)}frame(){this._iAmAlive&&(this.updateVelocity(),this.updatePosition(),this.updateCollisionBox(),this.updateDirection(),this.checkZones(),this.burnFuel(),console.log(this.velocity))}draw(){if(!this._iAmAlive)return void this.wereDoneFor();let t=this.getDrawingPos();const i=this._canvas.getContext("2d");if(i.imageSmoothingEnabled=!1,this._SPRITES){let e,s=1;const n={x:96,y:40};this._isTurning?(e=this._SPRITES.turn,s=this._direction==h.N.East?-1:1):e=this._direction==h.N.East?this._SPRITES.idleR:this._SPRITES.idleL,window.performance.now()-this._lastAnimationTick>=a.KN.animationInterval&&(this._spritesheetPosition.x+=n.x*s,(this._spritesheetPosition.x>=e.naturalWidth||this._spritesheetPosition.x<0)&&(this._spritesheetPosition.x=0,e=this._direction==h.N.East?this._SPRITES.idleR:this._SPRITES.idleL,this._isTurning=!1),this._lastAnimationTick=window.performance.now()),i.drawImage(e,this._spritesheetPosition.x,this._spritesheetPosition.y,n.x,n.y,t,this._position.y,this._size.x,this._size.y)}else i.fillStyle="gold",i.fillRect(t,this._position.y,this._size.x,this._size.y)}wereDoneFor(){const t=42,i=this.getDrawingPos(),e=3*this._engine.fpsStuff.frameCount;if(this._spritesheetPosition.x>=this._SPRITES.destroyed.naturalWidth)return void this._engine.delete(d.p.Player);const n=this._engine.level.OL_CANVAS.getContext("2d");n.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y,48,t,i-e,this._position.y,this._size.x/2,this._size.y),n.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y,48,t,i+e+this._size.x/2,this._position.y,this._size.x/2,this._size.y),n.filter=s.Z.randomColourFilter(),n.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y+t,48,t,i-e,this._position.y,this._size.x/2,this._size.y),n.filter=s.Z.randomColourFilter(),n.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y+t,48,t,i+e+this._size.x/2,this._position.y,this._size.x/2,this._size.y),n.filter=_.s.Black,window.performance.now()-this._lastAnimationTick>=a.KN.deathAnimationInterval&&(this._spritesheetPosition.x+=48,this._lastAnimationTick=window.performance.now())}updateVelocity(){let t=0;if(this._fuel>0){const i=window.performance.now()-this._accelerationTick>90;this._engine.input.up&&(t=-2*this._ACCELERATION),this._engine.input.down&&(t=this._ACCELERATION),this._engine.input.left&&i&&this.velocityFactor>-4&&(this.velocityFactor--,this._accelerationTick=window.performance.now()),this._engine.input.right&&i&&this.velocityFactor<4&&(this.velocityFactor++,this._accelerationTick=window.performance.now())}this._position.y+this._size.y>=this._engine.level.bounds.bl.y&&(this._engine.input.left?this._velocity.x=-1:this._engine.input.right&&(this._velocity.x=1),this.updateDirection(),this._velocity.scalarProduct(new o.F(0,1)),this.velocityFactor=0),this._velocity=new o.F(this._ACCELERATION*this.velocityFactor,t),this._velocity.addVector(new o.F(0,this._ACCELERATION/2))}updateDirection(){this._velocity.x>0&&this._direction==h.N.West?(this._isTurning=!0,this._direction=h.N.East,this._spritesheetPosition.x=384):this._velocity.x<0&&this._direction==h.N.East&&(this._isTurning=!0,this._direction=h.N.West,this._spritesheetPosition.x=0)}updatePosition(){let t=new n.J(this._size,this._position,this._engine,this._canvas.id);t.position.addVector(this._velocity),t.updateCollisionBox();const i=t.collided();let e=this._velocity.normalized();if(e.multiply(-.1),s.Z.isCollision(i)){if(Math.abs(this.velocityFactor)>=a.KN.criticalVelocityFactor&&(i.angle>162||i.angle>78&&i.angle<120||i.angle<30))return void this.die();for(this._velocity.multiply(0),this.velocityFactor=0;null!=t.collided();)t.position.addVector(e),t.updateCollisionBox();const s=this.isFloating(i.pointPos,i.point);if(s.isFloating){const t=2*a.KN.acceleration*(s.direction==h.N.East?1:-1);this._position.addVector(new o.F(t,4*-a.KN.minVelocityFactor))}this._position=t.position}else this._position.addVector(this._velocity),this._position.x+this._size.x>this._engine.level.bounds.tr.x?(this._position.x=this._engine.level.bounds.tr.x-this._size.x,this._velocity.x=0):this._position.x<this._engine.level.bounds.tl.x&&(this._position.x=this._engine.level.bounds.tl.x,this._velocity.x=0),this._position.y+this._size.y>=this._engine.level.bounds.bl.y?(this._position.y=this._engine.level.bounds.bl.y-this._size.y,this._velocity.multiply(0)):this._position.y<this._engine.level.bounds.tl.y&&(this._position.y=this._engine.level.bounds.tl.y)}checkZones(){this._engine.level.zones.map((t=>{if(t.isInside({x:this._collisionBox.bl.x+this._size.x/2,y:this._collisionBox.bl.y-1}))switch(t.type){case l.E.Refuel:this.refuel();break;case l.E.Resupply:this.resupply()}}))}burnFuel(){this._fuel<=0||window.performance.now()-this._lastFuelTick>=1e3*a.KN.fuelTickDuration&&(this._fuel--,this._lastFuelTick=window.performance.now())}shoot(){const t=this._engine.level.bridges;for(let i=0;i<t.length;i++)if(t[i].zone.isInside({x:this._collisionBox.bl.x+this._size.x/2,y:this._collisionBox.bl.y-1}))return void this.engineering(t[i]);if(this._ammo<=0)return;const i=this._position.copy();i.addXY({x:this._direction==h.N.East?this.size.x:0,y:this.size.y/3*2});const e=new o.F(this._direction==h.N.East?a.X4.rocket:-a.X4.rocket,0),s=new r.W(d.p.Player,{x:40,y:20},e,i,this._engine,this._canvas.id,this._ROCKET_SPRITE);this._engine.projectiles.push(s),this._ammo--,c.L.play("shot")}dropBomb(){if(this._bombs<=0||this._engine.input.shoot||0!=this._velocity.x)return;const t=this._position.copy();t.addXY({x:this.size.x/2,y:this.size.y});const i=new o.F(0,a.X4.bomb),e=new r.W(d.p.Player,{x:40,y:40},i,t,this._engine,this._canvas.id,this._BOMB_SPRITE);this._engine.projectiles.push(e),this._bombs--,c.L.play("shot")}refuel(){this._fuel<this.MAX_FUEL&&Date.now()-this._lastRefuelTick>1e3/a.KN.fuelPerRefuelSecond&&(this._fuel++,this._lastRefuelTick=Date.now())}resupply(){Date.now()-this._lastResupplyTick>1e3/a.KN.ammoPerResupplySecond&&(this._ammo<this._MAX_AMMO&&(this._ammo++,this._lastResupplyTick=Date.now()),this._bombs<this._MAX_BOMBS&&(this._bombs++,this._lastResupplyTick=Date.now()))}engineering(t){if(t.built)this._bridges++;else{if(t.built||!(this._bridges>0))return;this._bridges--}t.built=!t.built,c.L.play("engineering")}mayday(t){console.log(t),100==t&&this.die()}die(){this._spritesheetPosition.x=0,this._lastAnimationTick=window.performance.now(),this._iAmAlive=!1,this._engine.fpsStuff.frameCount=0,c.L.play("death")}async setRocketSprites(){let t=a.yH.rocket,i=new Image(100,100);i.src=t.idleRsrc,await i.decode();let e=new Image(100,100);e.src=t.idleLsrc,await e.decode(),this._ROCKET_SPRITE={idleR:i,idleL:e}}async setBombSprites(){let t=a.yH.bomb,i=new Image(100,100);i.src=t.idleRsrc,await i.decode(),this._BOMB_SPRITE={idleR:i}}getDrawingPos(){let t=this._engine.level.SCREEN_WIDTH/2-this._size.x/2;return this._engine.backgroundOffset<=0?t=this._position.x:5*this._engine.backgroundOffset+this._engine.level.SCREEN_WIDTH>=this._engine.level.bounds.tr.x&&(t=this._position.x-5*this._engine.backgroundOffset),t}isFloating(t,i){let e={isFloating:!1};if(this._isTurning)return e;const s="tr"==i&&this._direction==h.N.East&&t.x-this._collisionBox.bl.x<=this._size.x/3,n="tl"==i&&this._direction==h.N.West&&this._collisionBox.br.x-t.x<=this._size.x/3;return(s||n)&&(e={isFloating:!0,direction:this._direction}),e}get velocity(){return this._velocity}get canvas(){return this._canvas}get alive(){return this._iAmAlive}get ammo(){return this._ammo}get bombs(){return this._bombs}get fuel(){return this._fuel}get bridges(){return this._bridges}}},262:(t,i,e)=>{var s;e.d(i,{Z:()=>h}),function(t){t[t.Score=0]="Score",t[t.Bridges=1]="Bridges",t[t.Ammo=2]="Ammo",t[t.Bombs=3]="Bombs",t[t.Fps=4]="Fps",t[t.CarHP=5]="CarHP",t[t.ChopperHP=6]="ChopperHP"}(s||(s={}));var n=e(843),o=e(286),r=e(457);class h{static async drawBackground(t,i,e){this._LEVEL=e;let s=document.getElementById(t);const o=parseInt(window.getComputedStyle(document.body).height);s.width=this._LEVEL.SCREEN_WIDTH,s.height=o-this._LEVEL.BG_CANVAS.height;const r=s.getContext("2d");r.imageSmoothingEnabled=!1;const a=new Image(100,100);a.src=n.qd.backgroundSrc,a.onload=()=>{r.drawImage(a,0,0,s.width,s.height)},h._canvasName=i,s=document.getElementById(i),h._canvas=s,s.width=this._LEVEL.SCREEN_WIDTH,s.height=o-this._LEVEL.BG_CANVAS.height,h._charset=new Image(100,100),h._charset.src=n.qd.overlaySrc,await h._charset.decode(),h._fuelLowImg=new Image(100,100),h._fuelLowImg.src=n.qd.fuelLowImgSrc,await h._fuelLowImg.decode()}static draw(t,i,e,s,n,o,r,a){const l=h._canvas.getContext("2d");l.imageSmoothingEnabled=!1,l.clearRect(0,0,h._canvas.width,h._canvas.height),h.drawFuel(t,i),h.drawAllInfo(e,s,n,o,r,a)}static drawFuel(t,i){const e={x:.1446*h._canvas.width,y:7*h._canvas.height/30},s=.296*h._canvas.width,n=11*h._canvas.height/30,o=h._canvas.getContext("2d");o.fillStyle=r.g.Cyan,o.fillRect(e.x,e.y,(s-e.x)*t/i,n-e.y);let a=Math.round(window.performance.now()/1e3)%2==0;t/i<.15&&a&&h.drawFuelLow()}static async drawFuelLow(){if(!h._fuelLowImg)return;const t=h._LEVEL.OL_CANVAS.getContext("2d");t.filter=o.s.Red,t.drawImage(h._fuelLowImg,h._LEVEL.SCREEN_WIDTH/2-3*h._fuelLowImg.naturalWidth/2,20,3*h._fuelLowImg.naturalWidth,3*h._fuelLowImg.naturalHeight),t.filter=o.s.Black}static drawAllInfo(t,i,e,n,o,r,a=null){h.drawInfo(s.ChopperHP,t),h.drawInfo(s.CarHP,i),h.drawInfo(s.Score,e),h.drawInfo(s.Bridges,n),h.drawInfo(s.Ammo,o),h.drawInfo(s.Bombs,r)}static drawInfo(t,i){const e=h._canvas.getContext("2d");let n={x:0,y:37*h._canvas.height/60},r=1;switch(t){case s.Score:n.x=.472*h._canvas.width,r=6;break;case s.Bridges:n.x=.673*h._canvas.width,r=1;break;case s.Ammo:n.x=.748*h._canvas.width,r=3;break;case s.Bombs:n.x=.874*h._canvas.width,r=3;break;case s.ChopperHP:n.x=.07*h._canvas.width,n.y=.5*h._canvas.height,r=4;break;case s.CarHP:n.x=.195*h._canvas.width,n.y=.5*h._canvas.height,r=4;break;case s.Fps:n.x=0,n.y=0,r=i.toString().length}e.filter=o.s.White;const a=.025*h._canvas.width,l=2*h._canvas.height/15,_=h._charset.naturalWidth;i.toString().padStart(r,"0").split("").map(((t,i)=>{let s={x:216+8*parseInt(t),y:0};s.x>=_&&(s={x:s.x-=_,y:s.y+8}),e.drawImage(h._charset,s.x,s.y,8,8,n.x+i*a,n.y,a,l)})),e.filter=o.s.Black}set canvasName(t){h._canvasName=t,h._canvas=document.getElementById(h._canvasName)}get canvas(){return h._canvas}}},720:(t,i,e)=>{e.d(i,{W:()=>a});var s=e(843),n=e(286),o=e(909),r=e(158),h=e(823);class a extends r.J{constructor(t,i,e,s,n,o,r,h,a){super(i,s,n,o,a),this._velocity=e,this._SPRITES=r,this._parent=t,this._damages=!0,h?this._blowsUp=h:h=!1}frame(){this._engine.player?this.updatePosition():this.suicide()}draw(){if(!this._engine.player)return;if(!this._damages)return void this.blowUp();const t=this._canvas.getContext("2d");t.fillStyle="transparent";const i=this.getDrawingPos();if((i<0-this._size.x||i>this._engine.level.BG_CANVAS.width&&this._parent===o.p.Player)&&this.suicide(),t.fillRect(i,this._position.y,this._size.x,this._size.y),this._SPRITES){let e;e=this._SPRITES.idleL&&this._velocity.x<0?this._SPRITES.idleL:this._SPRITES.idleR;const s={x:e.naturalWidth,y:e.naturalHeight};this._blowsUp&&(t.filter=n.s.Yellow),t.drawImage(e,0,0,s.x,s.y,i,this._position.y,this._size.x,this._size.y),t.filter=n.s.Black}else t.fillStyle="red",t.fillRect(i,this._position.y,this._size.x,this._size.y)}blowUp(){const t=this.getDrawingPos();if(this._spritesheetPosition.x>=this._SPRITES.destroyed.naturalWidth)return void this.suicide();const i=this._canvas.getContext("2d");i.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y,48,42,t,this._position.y,this._size.x,this._size.y),i.filter=h.Z.randomColourFilter(),i.drawImage(this._SPRITES.destroyed,this._spritesheetPosition.x,this._spritesheetPosition.y+42,48,42,t,this._position.y,this._size.x,this._size.y),i.filter=n.s.Black,window.performance.now()-this._lastAnimationTick>=s.X_.jet.projectiles.deathAnimationInterval&&(this._spritesheetPosition.x+=48,this._lastAnimationTick=window.performance.now())}updatePosition(){this._damages&&(this._position.addVector(this._velocity),this.updateCollisionBox(),(this.hit()||this.isInLevelBounds(this))&&(this._blowsUp?(this._lastAnimationTick=0,this._damages=!1):this.suicide()))}isInLevelBounds(t){return t.position.x>t.engine.level.bounds.tr.x||t.position.x-t.size.x<t.engine.level.bounds.tl.x||t.position.y+t.size.y>t.engine.level.bounds.br.y}hit(){const t=this.collided(),i=this.collidedWith(this._parent);return h.Z.isCollision(t)?(t.target.isDestructible?t.target.destroy():t.parent.isDestructible&&t.parent.destroy(),!0):!!h.Z.isCollision(i)&&(i.parent===o.p.Jet?i.target.mayday(100):i.target.mayday(),!0)}collidedWith(t){const i={x:this._collisionBox.tl.x+this._size.x/2,y:this._collisionBox.tl.y+this._size.y/2};if(this._engine.car&&this._engine.car.isInside(i))return{point:"center",pointPos:i,angle:-1,parent:t,target:this._engine.car};switch(t){case o.p.Jet:case o.p.Enemy:if(this._engine.player.isInside(i))return{point:"center",pointPos:i,angle:-1,parent:t,target:this._engine.player};break;case o.p.Player:if(this._engine.jet&&this._engine.jet.isInside(i))return{point:"center",pointPos:i,angle:-1,parent:this._engine.player,target:this._engine.jet};for(let t=0;t<this._engine.enemies.length;t++){const e=this._engine.enemies[t];if(e.isInside(i))return{point:"center",pointPos:i,angle:-1,parent:this._engine.player,target:e}}break;default:return null}}getDrawingPos(){let t=this._position.x-this._engine.player.position.x-this._engine.player.size.x/2+this._engine.level.SCREEN_WIDTH/2;return this._engine.player.position.x<this._engine.level.SCREEN_WIDTH/2?t=this._position.x:this._engine.player.position.x>this._engine.level.bounds.tr.x-this._engine.level.SCREEN_WIDTH/2&&(t=this._position.x-5*this._engine.backgroundOffset),t}suicide(){this._engine.deleteProjectile(this)}get engine(){return this._engine}get damages(){return this._damages}get blowsUp(){return this._blowsUp}}},358:(t,i,e)=>{e.a(t,(async(t,s)=>{try{e.d(i,{$:()=>t});var n=e(455),o=e(332),r=e(89),h=e(843),a=e(448),l=e(382),_=e(456),c=e(27),d=e(909),p=e(875),g=e(262);class t{constructor(t){this.backgroundOffset=0,this._level=t,this.fpsStuff={fps:h.s_.fps,fpsInterval:null,now:null,then:null,start:null,frameCount:0}}async init(t=!0){this._player=new o.J(240,100,new r.F(3e3,100),this,h.Xl.gameCanvasId,h.yH.chopper),this._car=new l.l(120,100,new r.F(100,this._level.bounds.bl.y-100),new r.F(h.X4.car,0),this,h.Xl.gameCanvasId,h.yH.car),this._level.draw(0,!1),this._projectiles=[],this._enemies=[],this._canvas=document.getElementById(h.Xl.gameCanvasId),this.fpsStuff={fps:h.s_.fps,fpsInterval:null,now:null,then:null,start:null,frameCount:0},a.L.init(h.d0),t&&(this.setHtml(),this.setEventListeners(),g.Z.drawBackground(h.KN.guiBgCanvasId,h.KN.guiCanvasId,this._level))}setHtml(){document.getElementById(h.Xl.crtOn).checked=h.G5.crt}setEventListeners(){document.getElementById(h.Xl.crtOn).addEventListener("change",(t=>{h.G5.crt=t.target.checked,h.G5.crt?this._level.drawCRT():this._level.clearCRT()}))}start(){this.input=new n.I,this.input.start(this._player),this.fpsStuff.fpsInterval=1e3/this.fpsStuff.fps,this.fpsStuff.then=window.performance.now(),this.fpsStuff.start=window.performance.now(),this.frame(window.performance.now()),a.L.play("soundtrack")}clear(){this._canvas.getContext("2d").clearRect(0,0,this._canvas.width,this._canvas.height)}frame(t){this._raf=requestAnimationFrame((()=>this.frame(window.performance.now()))),this.fpsStuff.now=t;let i=this.fpsStuff.now-this.fpsStuff.then;this.trySpawnEnemies(d.p.Jet),this.trySpawnEnemies(d.p.Helikopter),this._player&&this._player.frame(),this._car&&this._car.frame(),this._enemies.map((t=>t.frame())),this._jet&&this._jet.frame(),this._projectiles.map((t=>t.frame())),i>=this.fpsStuff.fpsInterval&&(this.fpsStuff.frameCount++,this.fpsStuff.then=this.fpsStuff.now-i%this.fpsStuff.fpsInterval,this._level.draw(this.backgroundOffset,void 0===this._car),this.clear(),this._enemies.map((t=>{t.draw()})),this._jet&&this._jet.draw(),this._car&&this._car.draw(),this._player&&(this.updateBackgroundOffset(),this._player.draw()),this._player&&this._car&&g.Z.draw(this._player.fuel,this._player.MAX_FUEL,this._player.hp,h.DX.hitpoints-this._car.hp,this._player.score,this._player.bridges,this._player.ammo,this._player.bombs),this._projectiles.map((t=>t.draw())))}trySpawnEnemies(t){this.shouldSpawn(t)&&(t===d.p.Jet?this.spawnJet():this.spawnHelikopter())}shouldSpawn(t){return t===d.p.Jet?null==this._jet:this._enemies.length<h.s_.maxEnemies}spawnHelikopter(){const t=this._level.SCREEN_WIDTH*Math.random()*2;let i=new r.F(this._player.position.x+(Math.round(Math.random())?t:-t),-200);if(i.x<0||i.x>=this._level.bounds.tr.x)return void this.spawnHelikopter();const e=new p.h(120,100,i,this,this._canvas.id,h.yH.helikopter,y);this._enemies.push(e)}spawnJet(){const t=this._level.zones.filter((t=>t.type===c.E.JetTrigger));let i=Math.round(Math.random());const e=t[i],s=new r.F(t[1-i].position.x,-105),n=new r.F(i?h.X4.jet:-h.X4.jet,0),o=new _.z({x:240,y:105},s,n,2,e,this,h.Xl.gameCanvasId,h.yH.jet);this._jet=o}updateBackgroundOffset(){this.backgroundOffset=(this._player.position.x+this._player.size.x/2-this._level.SCREEN_WIDTH/2)/5,this.backgroundOffset<0?this.backgroundOffset=0:5*this.backgroundOffset+this._level.SCREEN_WIDTH>this._level.bounds.tr.x&&(this.backgroundOffset=(this._level.bounds.tr.x-this._level.SCREEN_WIDTH)/5)}deleteProjectile(t){const i=this._projectiles.indexOf(t);if(-1==i)throw new Error("Projectile not found in engine!");this._projectiles.splice(i,1)}deleteObstacle(t){const i=this._level.obstacles.indexOf(t);if(-1==i)throw new Error("Obstacle not found in engine!");this._level.obstacles.splice(i,1)}deleteEnemy(t){for(let i=0;i<this._enemies.length;i++)if(this._enemies[i]===t)return void this._enemies.splice(i,1);throw new Error("Enemy not found in engine!")}delete(t){switch(t){case d.p.Player:this._player=void 0,cancelAnimationFrame(this._raf),alert("PRZEGRANA"),this.init(!1),this.start();break;case d.p.Car:this._car=void 0;break;case d.p.Jet:this._jet=void 0}}get level(){return this._level}get player(){return this._player}get car(){return this._car}get jet(){return this._jet}get projectiles(){return this._projectiles}get enemies(){return this._enemies}}var y=await(async()=>{let t=new Image;t.src=h.yH.helikopter.idleRsrc,await t.decode();let i={idleR:t},e=new Image(100,100);e.src=h.yH.helikopter.idleLsrc,await e.decode(),i.idleL=e;let s=new Image(100,100);s.src=h.yH.helikopter.turnSrc,await s.decode(),i.turn=s;let n=new Image(100,100);return n.src=h.yH.helikopter.destroyedSrc,await n.decode(),i.destroyed=n,i})();s()}catch(t){s(t)}}),1)},89:(t,i,e)=>{e.d(i,{F:()=>s});class s{constructor(t,i){this._x=t,this._y=i,this.setMagnitude()}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}addXY(t){this._x+=t.x,this._y+=t.y,this.setMagnitude()}addVector(...t){t.map((t=>{this._x+=t.x,this._y+=t.y})),this.setMagnitude()}multiply(t){this._x*=t,this._y*=t,this.setMagnitude()}scalarProduct(t){this._x*=t.x,this._y*=t.y}round(t=3){this._x=Math.round(this._x*Math.pow(10,t))/Math.pow(10,t),this._y=Math.round(this._y*Math.pow(10,t))/Math.pow(10,t)}copy(){return new s(this._x,this._y)}normalized(){let t=this.copy();return t.multiply(1/this.magnitude),t.round(),t}setMagnitude(){this._magnitude=Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))}get magnitude(){return this._magnitude}}},286:(t,i,e)=>{var s;e.d(i,{s:()=>s}),function(t){t.Black="none",t.ForceBlack="brightness(0%)",t.White="invert(100%)",t.Red="invert(21%) sepia(34%) saturate(4364%) hue-rotate(343deg) brightness(99%) contrast(89%)",t.Cyan="invert(83%) sepia(12%) saturate(969%) hue-rotate(149deg) brightness(101%) contrast(95%)",t.Violet="invert(69%) sepia(84%) saturate(7049%) hue-rotate(278deg) brightness(90%) contrast(84%)",t.Green="invert(73%) sepia(55%) saturate(6757%) hue-rotate(111deg) brightness(100%) contrast(106%)",t.Blue="invert(12%) sepia(100%) saturate(5109%) hue-rotate(244deg) brightness(62%) contrast(138%)",t.Yellow="invert(82%) sepia(91%) saturate(278%) hue-rotate(358deg) brightness(105%) contrast(87%)",t.Orange="invert(74%) sepia(54%) saturate(2218%) hue-rotate(323deg) brightness(95%) contrast(81%)",t.Brown="invert(14%) sepia(99%) saturate(3996%) hue-rotate(54deg) brightness(91%) contrast(101%)",t.LightRed="invert(61%) sepia(11%) saturate(4975%) hue-rotate(316deg) brightness(108%) contrast(110%)",t.DarkGrey="invert(13%) sepia(6%) saturate(0%) hue-rotate(193deg) brightness(92%) contrast(79%)",t.Grey="invert(50%) sepia(0%) saturate(0%) hue-rotate(81deg) brightness(92%) contrast(87%)",t.LightGreen="invert(78%) sepia(51%) saturate(463%) hue-rotate(43deg) brightness(107%) contrast(101%)",t.LightBlue="invert(63%) sepia(45%) saturate(5360%) hue-rotate(209deg) brightness(92%) contrast(96%)",t.LightGrey="invert(81%) sepia(6%) saturate(0%) hue-rotate(205deg) brightness(91%) contrast(93%)"}(s||(s={}))},457:(t,i,e)=>{var s;e.d(i,{g:()=>s}),function(t){t.Black="#000000",t.White="#FFFFFF",t.Red="#af2a29",t.Cyan="#99e6f9",t.Violet="#CC44CC",t.Green="#00CC55",t.Blue="#0000AA",t.Yellow="#EEEE77",t.Orange="#DD8855",t.Brown="#664400",t.LightRed="#FF7777",t.DarkGrey="#333333",t.Grey="#777777",t.LightGreen="#AAFF66",t.LightBlue="#707ce6",t.LightGrey="#BBBBBB"}(s||(s={}))},2:(t,i,e)=>{var s;e.d(i,{N:()=>s}),function(t){t.East="E",t.West="W",t.North="N",t.South="S"}(s||(s={}))},909:(t,i,e)=>{var s;e.d(i,{p:()=>s}),function(t){t[t.Player=0]="Player",t[t.Enemy=1]="Enemy",t[t.Jet=2]="Jet",t[t.Helikopter=3]="Helikopter",t[t.Car=4]="Car"}(s||(s={}))},27:(t,i,e)=>{var s;e.d(i,{E:()=>s}),function(t){t[t.Refuel=0]="Refuel",t[t.Resupply=1]="Resupply",t[t.Exit=2]="Exit",t[t.Bridge=3]="Bridge",t[t.JetTrigger=4]="JetTrigger"}(s||(s={}))},410:(t,i,e)=>{e.d(i,{aT:()=>a,Sj:()=>c,Ao:()=>d});var s=e(843),n=e(158),o=e(89);class r extends n.J{constructor(t,i,e){super(t,i,null,null),this._type=e}get type(){return this._type}}var h=e(27);const a={size:{x:12800,y:680},bridgesVisible:[0,3],backgroundSrc:"./src/gfx/levels/A/base.bmp",overlaySrc:"./src/gfx/levels/A/overlay.bmp"},l=[new n.J({x:40,y:40},new o.F(11240,360),null,s.Xl.backgroundCanvasId,s.yH.spike,!0),new n.J({x:40,y:40},new o.F(11240,400),null,s.Xl.backgroundCanvasId,s.yH.spike,!0),new n.J({x:40,y:40},new o.F(11240,440),null,s.Xl.backgroundCanvasId,s.yH.spike,!0),new n.J({x:40,y:40},new o.F(11240,480),null,s.Xl.backgroundCanvasId,s.yH.spike,!0)],_=[new n.J({x:30,y:40},new o.F(11290,360),null,s.Xl.backgroundCanvasId,s.yH.wall,!0),new n.J({x:30,y:40},new o.F(11290,400),null,s.Xl.backgroundCanvasId,s.yH.wall,!0),new n.J({x:30,y:40},new o.F(11290,440),null,s.Xl.backgroundCanvasId,s.yH.wall,!0),new n.J({x:30,y:40},new o.F(11290,480),null,s.Xl.backgroundCanvasId,s.yH.wall,!0)],c=[new n.J({x:640,y:30},new o.F(0,320),null,s.Xl.gameCanvasId),new n.J({x:640,y:30},new o.F(0,40),null,s.Xl.gameCanvasId),new n.J({x:600,y:30},new o.F(4840,360),null,s.Xl.gameCanvasId),new n.J({x:240,y:80},new o.F(5200,280),null,s.Xl.gameCanvasId),new n.J({x:242,y:30},new o.F(12560,320),null,s.Xl.gameCanvasId),...l,..._],d=[new r({x:120,y:15},new o.F(6920,500),h.E.Bridge),new r({x:120,y:15},new o.F(7080,500),h.E.Bridge),new r({x:120,y:15},new o.F(9360,500),h.E.Bridge),new r({x:120,y:15},new o.F(9200,500),h.E.Bridge),new r({x:160,y:35},new o.F(4920,325),h.E.Resupply),new r({x:160,y:35},new o.F(5240,245),h.E.Refuel),new r({x:40,y:180},new o.F(12760,345),h.E.Exit),new r({x:200,y:200},new o.F(1e3,-105),h.E.JetTrigger),new r({x:200,y:200},new o.F(12e3,-105),h.E.JetTrigger)]},423:(t,i,e)=>{e.a(t,(async(t,i)=>{try{var s=e(937),n=e(358),o=e(410),r=t([n]);n=(r.then?(await r)():r)[0];const h=new s.a(o.aT.backgroundSrc,o.aT.overlaySrc,{tr:{x:o.aT.size.x,y:-80},br:{x:o.aT.size.x,y:515},tl:{x:0,y:-80},bl:{x:0,y:515}},null,o.Sj,o.Ao,o.aT.bridgesVisible);let a=new n.$(h);h.engine=a,await a.init(),a.start(),i()}catch(t){i(t)}}),1)}},h={};function a(t){var i=h[t];if(void 0!==i)return i.exports;var e=h[t]={exports:{}};return r[t](e,e.exports,a),e.exports}t="function"==typeof Symbol?Symbol("webpack then"):"__webpack_then__",i="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",e="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",s=t=>{t&&(t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},n=t=>!--t.r&&t(),o=(t,i)=>t?t.push(i):n(i),a.a=(r,h,a)=>{var l,_,c,d=a&&[],p=r.exports,g=!0,y=!1,u=(i,e,s)=>{y||(y=!0,e.r+=i.length,i.map(((i,n)=>i[t](e,s))),y=!1)},w=new Promise(((t,i)=>{c=i,_=()=>(t(p),s(d),d=0)}));w[i]=p,w[t]=(t,i)=>{if(g)return n(t);l&&u(l,t,i),o(d,t),w.catch(i)},r.exports=w,h((r=>{var h;l=(r=>r.map((r=>{if(null!==r&&"object"==typeof r){if(r[t])return r;if(r.then){var h=[];r.then((t=>{a[i]=t,s(h),h=0}),(t=>{a[e]=t,s(h),h=0}));var a={};return a[t]=(t,i)=>(o(h,t),r.catch(i)),a}}var l={};return l[t]=t=>n(t),l[i]=r,l})))(r);var a=()=>l.map((t=>{if(t[e])throw t[e];return t[i]})),_=new Promise(((t,i)=>{(h=()=>t(a)).r=0,u(l,h,i)}));return h.r?_:a()}),(t=>(t&&c(w[e]=t),_()))),g=!1},a.d=(t,i)=>{for(var e in i)a.o(i,e)&&!a.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},a.o=(t,i)=>Object.prototype.hasOwnProperty.call(t,i),a(423)})();